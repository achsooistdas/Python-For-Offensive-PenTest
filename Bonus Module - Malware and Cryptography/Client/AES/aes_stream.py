# Download Pycrypto for Windows - pycrypto 2.6 for win32 py 2.7
# http://www.voidspace.org.uk/python/modules.shtml#pycrypto

# Download Pycrypto source
# https://pypi.python.org/pypi/pycrypto
# For Kali, after extract the tar file, invoke "python setup.py install"

import os
from Crypto.Cipher import AES

# AES - 2 modes - stream and block mode

# CTR counter string value with length of 16 bytes.
counter = os.urandom(16)
# AES keys may be 128 bits (16 bytes), 192 bits (24 bytes) or 256 bits (32 bytes) long.
key = os.urandom(32)


# instantiate a crypto object called enc
enc = AES.new(key, AES.MODE_CTR, counter=lambda: counter) # counter must be a callable object, so we use lambda to "create a anonymous function"
encrypted = enc.encrypt("Daniel QWE123"*100)
print encrypted


# and a crypto object for decryption
dec = AES.new(key, AES.MODE_CTR, counter=lambda: counter)
decrypted =  dec.decrypt(encrypted)
print decrypted

