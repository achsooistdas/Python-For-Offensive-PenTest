import win32net
import win32netcon

import os
import ctypes

import locale


# define a new username nd make it belong to 'administrators' group.
 
USER = "myAdminUser"

GROUP = "Administratoren"
#
# REMINDER - localization of group names 
# en_us: Administrators
# de_de: Administratoren
#
if locale.getlocale()[0] is None:
	locale.setlocale(locale.LC_ALL, '')
	x = locale.getlocale()
	if x[0] == "de_DE":
		GROUP = "Administratoren"	
	else:
		GROUP = "Administrators"


# create a user info profile in a dictionary format
user_info = dict (
    name = USER,
    password = "my_pwd", # Define the password for the new user
    priv = win32netcon.USER_PRIV_USER,
    home_dir = None,
    comment = None,
    flags = win32netcon.UF_SCRIPT,
    script_path = None
)

# create a group info profile in a dictionary format
user_group_info = dict (
    domainandname = USER
)

try:
    win32net.NetUserAdd (None, 1, user_info)
    win32net.NetLocalGroupAddMembers (None, GROUP, 3, [user_group_info])
except Exception, x:
    print str(x)
    pass
